{% extends 'base.html' %}
{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h4">Admin Messages</h1>
    <div class="d-flex gap-2">
      <a class="btn btn-outline-primary" href="{{ url_for('admin_email_settings') }}"><i class="bi bi-gear"></i> Email Settings</a>
      <a class="btn btn-outline-secondary" href="{{ url_for('admin_dashboard') }}">Dashboard</a>
    </div>
  </div>

  <form method="post" enctype="multipart/form-data" class="row g-3">
    <div class="col-12">
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" id="send_email" name="send_email">
        <label class="form-check-label" for="send_email">Send Email (Gmail SMTP)</label>
      </div>
    </div>
    <div class="col-md-6">
      <label class="form-label" for="to_email">To Email</label>
      <input type="email" class="form-control" id="to_email" name="to_email" placeholder="recipient@example.com">
      <div class="form-text">Configured via SMTP_* env vars. From: EMAIL_FROM or SMTP_USER.</div>
    </div>
    <div class="col-md-6">
      <label class="form-label" for="subject">Subject</label>
      <input class="form-control" id="subject" name="subject" placeholder="Subject">
    </div>
    <div class="col-12">
      <label class="form-label" for="body">Message Body</label>
      <textarea class="form-control" id="body" name="body" rows="6" placeholder="Write your message..."></textarea>
    </div>

    <div class="col-12">
      <hr>
    </div>

    <div class="col-12">
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" id="make_whatsapp" name="make_whatsapp">
        <label class="form-check-label" for="make_whatsapp">Generate WhatsApp Link</label>
      </div>
    </div>
    <div class="col-md-4">
      <label class="form-label" for="wa_phone">WhatsApp Number</label>
      <input class="form-control" id="wa_phone" name="wa_phone" placeholder="e.g., 919876543210">
      <div class="form-text">Use country code (only digits). Example: 91XXXXXXXXXX</div>
    </div>
    <div class="col-md-8">
      <label class="form-label" for="wa_text">WhatsApp Text</label>
      <input class="form-control" id="wa_text" name="wa_text" placeholder="Short message for WhatsApp">
    </div>

    <div class="col-12">
      <label class="form-label" for="attachment">Attachment (optional)</label>
      <input type="file" class="form-control" id="attachment" name="attachment" accept="image/*,.pdf,.txt,.doc,.docx,.xls,.xlsx,.zip">
      <div class="form-text">Images, PDF, DOC(X), XLS(X), ZIP. Max few MB recommended.</div>
    </div>

    <div class="col-12">
      <button class="btn btn-primary" type="submit">Send / Generate</button>
      <a class="btn btn-outline-secondary" href="{{ url_for('admin_dashboard') }}">Cancel</a>
    </div>
  </form>

  {% if wa_url %}
  <div class="alert alert-info mt-4" role="alert">
    <div class="mb-2"><strong>WhatsApp Link:</strong></div>
    <a href="{{ wa_url }}" target="_blank" rel="noopener" class="btn btn-success">Open in WhatsApp</a>
    <div class="small mt-2 text-break"><code>{{ wa_url }}</code></div>
  </div>
  {% endif %}
{% endblock %}
